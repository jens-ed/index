<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scaleble=no, initial-scale=1.0, maximum-scale=1.0">
	<title>fgg</title>
</head>
<body>

選擇模式: 
阿誠:<input  type="radio" name="level" value="easy" checked>
小強:<input  type="radio" name="level" value="normal">
威力:<input  type="radio" name="level" value="hard">
<br />
<br />
選擇一拳:
剪刀:<input  type="radio" name="fgg" value="2" checked>
石頭:<input  type="radio" name="fgg" value="0">
布:<input  type="radio" name="fgg" value="5">
<br />
<br />
<input type="button" id="run" value="run"/>
<input type="button" id="clear" value="clear"/>
<br />
<br />
<div id="scorebook"></div>
<br />
<div id="guestbook"></div>

<script type="text/javascript">

	var index = 1;
	var remove_index = 1;
	var win = 0;
	var lose = 0;
	var mind = 0;
	
	/*
	* 取得選取的值 radio button
	*/
	var radio_value = function(elm_name) {
		var level = document.getElementsByName(elm_name);
		var len = level.length;
		var i = 0;

		for(i; i<len; i++) {
			if(level[i].checked == true) {
				//console.log(level[i].value);
				return level[i].value;
			}
		}
	};
	
	/*
	* 寫入div
	*/
	var set_guestbook = function(content) {
		var guestbook = document.getElementById('guestbook');
		var guestbook_row = document.createElement('div');
		var remove =  '';
		
		guestbook_row.setAttribute("id", "row" + index);
		guestbook_row.innerHTML = index + ' : ' + content;

		if(index > 10) {
			remove = document.getElementById('row' + remove_index);
			guestbook.removeChild(remove);
			remove_index++;
		} else {
		
		}

		guestbook.appendChild(guestbook_row);

		//console.log(index + '_' + remove_index);
		
		index++;
	}
	
	/*
	* 清除div
	*/
	var clear_guestbook = function() {
		document.getElementById('guestbook').innerHTML = '';
		index = 1;
	}
	
	var set_scorebook = function() {
		var scorebook = document.getElementById('scorebook');
		
		var total = win + lose + mind;
		var _win = parseInt(win/total*100);
		var _lose = parseInt(lose/total*100);
		var _mind = parseInt(mind/total*100);
		
		scorebook.innerHTML = '總場數:' + total + 
		                      ', 勝率:' + _win +
		                      ', 敗率:' + _lose +
		                      ', 平率:' + _mind;
	}
	
	/*
	* 開始拉!
	*/
	var fgg = function(level, fgg) {
		var list = {
			'easy':[30, 30, 30], 
			'normal':[30, 20, 10], 
			'hard':[10, 30, 30], 
		};
		var key2val = {1:2, 2:0, 3:5};
		var val = return_array_num(list[level]);
		
		var val2txt = {2:'剪刀', 0:'石頭', 5:'布'};
		//console.log(fgg+'_'+key2val[val]);
		
		switch(fgg+'_'+key2val[val]) {
			case '2_5':
			case '0_2':
			case '5_0':
				win += 1;
				set_guestbook('你出' + val2txt[fgg] + ', 對方出' + val2txt[key2val[val]] + ', 你贏了!');
				break;
			case '2_0':
			case '0_5':
			case '5_2':
				lose += 1;
				set_guestbook('你出' + val2txt[fgg] + ', 對方出' + val2txt[key2val[val]] + ', 你輸了!');
				break;
			default:
				mind += 1;
				set_guestbook('你出' + val2txt[fgg] + ', 對方出' + val2txt[key2val[val]] + ', 雙方平手!');
				break;
		}
		
		set_scorebook();
	}	
	
	/*
	* 按鈕事件
	*/
	var run = document.getElementById('run');
	var clear = document.getElementById('clear');

	run.onclick = function() {
	
		var level_val = radio_value('level');
		var fgg_val = radio_value('fgg');
		
		fgg(level_val, fgg_val);
		
	}
	
	clear.onclick = function() {
		clear_guestbook();
	}
	
	/*
	* 隨機數
	*/
	function usefloor(min, max) {
		return Math.floor(Math.random()*(max-min+1)+min);
	}
	
	/*
	* 不定機率
	*/
	var return_array_num = function(ary) {
		var result = 0, total = 0, list_val = 0;
		var i = 0, list = [], rand = 0, len = ary.length;

		for(var k in ary) {
			total += ary[k];
			list_val = 0;
			for(i=0; i<=k; i++) {                
				list_val += ary[i];
			}
			list[parseInt(k)+1] = list_val;
		}
		rand = usefloor(1, total);
		
		for(i=1; i<=len; i++) {
			if(rand <= list[i]) {
				result = i;  //開的值落的範圍
				break;
			}
		}
		return result;
	}

</script>

<script>

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50817771-1', 'shesheshe.github.io');
  ga('send', 'pageview');

</script>
</body>
</html>